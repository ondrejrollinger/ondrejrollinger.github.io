<nav class="toc" id="toc" aria-label="Table of contents">
  <h2 class="toc__title">Contents</h2>
  <ul class="toc__list" id="toc-list"></ul>
</nav>

<script>
  (function () {
    const article = document.querySelector('.post-content') || document.querySelector('article') || document.body;
    const headings = article.querySelectorAll('h2, h3');
    const list = document.getElementById('toc-list');
    if (!list || headings.length < 2) {
      document.getElementById('toc').style.display = 'none';
      return;
    }

    headings.forEach(function (h) {
      if (!h.id) {
        h.id = h.textContent.trim().toLowerCase()
          .replace(/[^\w\s-]/g, '')
          .replace(/\s+/g, '-');
      }
      const li = document.createElement('li');
      li.className = h.tagName === 'H3' ? 'toc__item toc__item--sub' : 'toc__item';
      const a = document.createElement('a');
      a.href = '#' + h.id;
      a.textContent = h.textContent;
      li.appendChild(a);
      list.appendChild(li);
    });
  })();
</script>
