<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IDS Lab Kanban Tracker | ondrejrollinger.github.io</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      background-color: #0a0e14;
      color: #b3b1ad;
      min-height: 100vh;
      overflow-x: auto;
    }

    /* Scanline overlay */
    body::after {
      content: '';
      position: fixed;
      inset: 0;
      pointer-events: none;
      background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.07) 2px,
        rgba(0, 0, 0, 0.07) 4px
      );
      z-index: 9999;
    }

    #root {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ── Header ── */
    .header {
      border-bottom: 1px solid #1e2530;
      padding: 14px 24px;
      display: flex;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    .header-title {
      font-size: 0.9rem;
      font-weight: 600;
      letter-spacing: 0.05em;
      white-space: nowrap;
    }

    .header-prompt {
      color: #00ff9f;
      font-size: 13px;
      font-weight: 700;
    }

    .header-path {
      color: #4a7a4a;
      font-size: 12px;
    }

    .header-divider {
      width: 1px;
      height: 20px;
      background: #1e2530;
      flex-shrink: 0;
    }

    .filters {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .filter-label {
      font-size: 0.7rem;
      color: #4d5566;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .filter-btn {
      font-family: inherit;
      font-size: 0.72rem;
      padding: 3px 10px;
      border-radius: 3px;
      border: 1px solid transparent;
      cursor: pointer;
      background: transparent;
      transition: all 0.15s;
      letter-spacing: 0.03em;
    }

    .filter-btn.active {
      border-color: currentColor;
    }

    .filter-btn:not(.active) {
      opacity: 0.45;
    }

    .filter-btn:not(.active):hover {
      opacity: 0.75;
    }

    /* ── Board ── */
    .board {
      display: flex;
      gap: 16px;
      padding: 20px 24px;
      flex: 1;
      overflow-x: auto;
      align-items: flex-start;
    }

    .column {
      flex: 1;
      min-width: 230px;
      max-width: 320px;
      background: #0d1117;
      border: 1px solid #1e2530;
      border-radius: 4px;
      display: flex;
      flex-direction: column;
    }

    .column-header {
      padding: 10px 14px;
      display: flex;
      align-items: center;
      gap: 8px;
      border-bottom: 1px solid #1e2530;
    }

    .column-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .column-title {
      font-size: 12px;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 3px;
    }

    .column-count {
      margin-left: auto;
      font-size: 0.65rem;
      color: #4d5566;
      background: #1a1f28;
      padding: 1px 6px;
      border-radius: 10px;
    }

    .column-body {
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      min-height: 60px;
    }

    /* ── Card ── */
    .card {
      background: #0f1318;
      border: 1px solid #1e2530;
      border-radius: 3px;
      padding: 10px 12px;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s, transform 0.1s;
      overflow: hidden;
    }

    .card:hover {
      background: #141b24;
      border-color: #3a4a5c;
      transform: translateY(-1px);
    }

    .card-top {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .card-symbol {
      font-size: 0.75rem;
      flex-shrink: 0;
      margin-top: 1px;
    }

    .card-title {
      font-size: 0.8rem;
      font-weight: 600;
      color: #e6e1cf;
      line-height: 1.3;
      flex: 1;
    }

    .card-note {
      font-size: 0.68rem;
      color: #4d5566;
      margin-top: 6px;
      padding-left: 20px;
      line-height: 1.4;
      font-style: italic;
    }

    /* ── Card progress bar ── */
    .card-progress-track {
      height: 2px;
      background: #1e2530;
      margin-top: 10px;
      border-radius: 1px;
      overflow: hidden;
    }

    .card-progress-fill {
      height: 100%;
      border-radius: 1px;
      transition: width 0.2s;
    }

    /* ── Empty state ── */
    .empty-state {
      font-size: 0.68rem;
      color: #2e3a4a;
      text-align: center;
      padding: 16px 8px;
    }

    /* ── Detail Modal ── */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.72);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      animation: overlayIn 0.15s ease;
    }

    @keyframes overlayIn {
      from { opacity: 0; }
      to   { opacity: 1; }
    }

    .modal-panel {
      background: #0d1117;
      border: 1px solid #1e2530;
      border-radius: 4px;
      width: 100%;
      max-width: 560px;
      max-height: 90vh;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      animation: panelIn 0.15s ease;
    }

    @keyframes panelIn {
      from { opacity: 0; transform: translateY(8px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .modal-header {
      padding: 16px 20px 14px;
      border-bottom: 1px solid #1e2530;
    }

    .modal-meta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .modal-category {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.04em;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .modal-column-badge {
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.08em;
      padding: 2px 8px;
      border-radius: 2px;
      border: 1px solid currentColor;
      text-transform: uppercase;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 700;
      color: #f0f6fc;
      line-height: 1.3;
      margin-bottom: 4px;
    }

    .modal-note {
      font-size: 11px;
      color: #a0aab4;
      font-style: italic;
    }

    .modal-body {
      padding: 16px 20px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .modal-section-heading {
      font-size: 10px;
      color: #6e7681;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      margin-bottom: 8px;
    }

    .modal-description {
      font-size: 13px;
      color: #c9d1d9;
      line-height: 1.7;
    }

    .modal-phases-summary {
      font-size: 11px;
      font-weight: 600;
      margin-bottom: 10px;
    }

    .phases-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .phase-row {
      display: flex;
      align-items: flex-start;
      gap: 10px;
    }

    /* Custom checkbox */
    .phase-checkbox {
      appearance: none;
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      border: 1px solid #3a4a5c;
      border-radius: 2px;
      background: #0a0e14;
      cursor: pointer;
      flex-shrink: 0;
      margin-top: 1px;
      position: relative;
      transition: background 0.1s, border-color 0.1s;
    }

    .phase-checkbox:checked {
      background: var(--check-color, #00ff9f);
      border-color: var(--check-color, #00ff9f);
    }

    .phase-checkbox:checked::after {
      content: '';
      position: absolute;
      left: 3px;
      top: 1px;
      width: 5px;
      height: 8px;
      border: 2px solid #0a0e14;
      border-top: none;
      border-left: none;
      transform: rotate(45deg);
    }

    input[type="checkbox"]:disabled {
      cursor: default;
      opacity: 1;
    }

    .phase-label {
      font-size: 12px;
      color: #c9d1d9;
      line-height: 1.5;
      cursor: pointer;
      transition: color 0.1s;
    }

    .phase-label.done {
      color: #4a5568;
      text-decoration: line-through;
    }

    .modal-footer {
      padding: 12px 20px;
      border-top: 1px solid #1e2530;
      display: flex;
      justify-content: flex-end;
    }

    .modal-close-btn {
      font-family: inherit;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.06em;
      color: #6e7681;
      background: transparent;
      border: 1px solid #1e2530;
      border-radius: 3px;
      padding: 6px 14px;
      cursor: pointer;
      transition: color 0.15s, border-color 0.15s;
    }

    .modal-close-btn:hover {
      color: #b3b1ad;
      border-color: #3a4a5c;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useCallback } = React;

    // ── Constants ──────────────────────────────────────────────────────────
    const COLUMNS = ['Backlog', 'Planned', 'In Progress', 'Done'];

    const COLUMN_COLORS = {
      'Backlog':     '#6e7d8c',
      'Planned':     '#38bdf8',
      'In Progress': '#f59e0b',
      'Done':        '#00ff9f',
    };

    const CATEGORIES = {
      'lab':       { label: 'Lab Dev',        color: '#00ff9f', symbol: '●' },
      'theory':    { label: 'Theory Post',    color: '#38bdf8', symbol: '◆' },
      'practical': { label: 'Practical Post', color: '#f59e0b', symbol: '▲' },
      'idea':      { label: 'Future Idea',    color: '#a78bfa', symbol: '★' },
    };

    const CARDS = [
      // ── Done cards — published posts, ordered by date descending ──────────
      {
        id: "p4",
        title: "Local Jekyll Setup for GitHub Pages (Kali Linux)",
        category: "practical",
        column: "Done",
        note: "Published 2026-02-23",
        description: "Documents the reproducible local Jekyll dev environment for the GitHub Pages site on Kali Linux, covering the webrick dependency, gem path isolation with GEM_HOME, gitignore configuration for _site and Gemfile.lock, Liquid tag fixes, and the local config override for serving.",
        phases: [
          { id: "p4-1", label: "Set up local Ruby and Bundler environment", done: true },
          { id: "p4-2", label: "Resolve webrick and permission issues", done: true },
          { id: "p4-3", label: "Configure _config_local.yml and .gitignore", done: true },
          { id: "p4-4", label: "Verify clean local build with jekyll serve", done: true },
          { id: "p4-5", label: "Write and publish post", done: true },
        ]
      },
      {
        id: "p3",
        title: "802.1Q: How VLAN Tagging Actually Works",
        category: "theory",
        column: "Done",
        note: "Published 2026-02-20",
        description: "A deep-dive into the 802.1Q standard explaining how VLAN tags are inserted into Ethernet frames. Covers the TPID and TCI fields, VID encoding, frame size implications, how non-802.1Q devices handle tagged frames, and how the standard connects to PVID and port type configuration.",
        phases: [
          { id: "p3-1", label: "Research 802.1Q frame format and field definitions", done: true },
          { id: "p3-2", label: "Draft post outline covering TPID, TCI, VID, PVID link", done: true },
          { id: "p3-3", label: "Write post with ASCII diagrams and explanations", done: true },
          { id: "p3-4", label: "Publish post", done: true },
        ]
      },
      {
        id: "p2",
        title: "Understanding VLANs and PVID: A Practical Guide",
        category: "theory",
        column: "Done",
        note: "Published 2026-02-19",
        description: "A practical breakdown of how VLANs and PVID work, drawn from real troubleshooting during home lab setup. Covers 802.1Q tagging, tagged vs. untagged ports, the PVID misconfiguration that silently drops wired device traffic while WiFi works, and the golden rule for access port configuration.",
        phases: [
          { id: "p2-1", label: "Document PVID misconfiguration root cause from lab", done: true },
          { id: "p2-2", label: "Write explanation of tagged vs. untagged ports", done: true },
          { id: "p2-3", label: "Add complete traffic flow walkthrough", done: true },
          { id: "p2-4", label: "Publish post", done: true },
        ]
      },
      {
        id: "p1",
        title: "Home IDS Lab — VLAN Segmentation on MikroTik and TP-Link",
        category: "practical",
        column: "Done",
        note: "Published 2026-02-17",
        description: "Full VLAN configuration across MikroTik E50UG router and TP-Link TL-SG108E switch for a three-VLAN home IDS lab (User VLAN 20, IoT VLAN 30, Guest VLAN 40). Documents the management lockout problem, PVID misconfiguration on wired ports, and verification evidence for all five success criteria.",
        phases: [
          { id: "p1-1", label: "Configure VLANs and DHCP on MikroTik E50UG", done: true },
          { id: "p1-2", label: "Configure PVID and port assignments on TL-SG108E", done: true },
          { id: "p1-3", label: "Verify DHCP assignment per VLAN", done: true },
          { id: "p1-4", label: "Verify gateway reachability and internet access", done: true },
          { id: "p1-5", label: "Write and publish practical post", done: true },
        ]
      },

      // ── In Progress cards ────────────────────────────────────────────────
      {
        id: "wg-1",
        title: "MikroTik WireGuard Client Setup",
        category: "lab",
        column: "In Progress",
        note: "MikroTik E50UG → VPS WireGuard hub | Priority: Medium",
        description: "Configure MikroTik E50UG as a WireGuard client connecting to a VPS WireGuard server for remote access to home network VLANs (users, IoT, guest, servers). Raspberry Pi runs Pi-hole and Home Assistant on the server VLAN. VPS acts as WireGuard hub. Goal is secure remote access to all home VLANs.",
        phases: [
          { id: "wg-1-1", label: "Configure WireGuard peer on MikroTik", done: false },
          { id: "wg-1-2", label: "Set up correct routing for all home VLANs through tunnel", done: false },
          { id: "wg-1-3", label: "Configure VPS peer block with home subnet AllowedIPs", done: false },
          { id: "wg-1-4", label: "Fallback: Raspberry Pi as WireGuard client if MikroTik has limitations", done: false },
          { id: "wg-1-5", label: "Verify Pi-hole accessible remotely via tunnel for DNS", done: false },
          { id: "wg-1-6", label: "Confirm remote access to Home Assistant", done: false },
          { id: "wg-1-7", label: "Test connectivity to all VLANs from remote client", done: false },
          { id: "wg-1-8", label: "Document final working configuration", done: false },
        ]
      },

      // ── Backlog cards — next steps from posts, source date descending ─────
      {
        id: "ns-8",
        title: "Fix Sass Deprecation Warnings from jekyll-theme-hacker",
        category: "practical",
        column: "Backlog",
        note: "Next step from Jekyll setup post",
        description: "The Jekyll theme hacker 0.2.0 produces Sass deprecation warnings that will not fail the build before Dart Sass 3.0. Monitor the theme for an update, upgrade when available, and verify warnings are resolved without introducing new issues in CI or locally.",
        phases: [
          { id: "ns-8-1", label: "Monitor jekyll-theme-hacker for a new release", done: false },
          { id: "ns-8-2", label: "Update gem version in Gemfile", done: false },
          { id: "ns-8-3", label: "Test local build for warning elimination", done: false },
          { id: "ns-8-4", label: "Verify CI passes after theme update", done: false },
        ]
      },
      {
        id: "ns-9",
        title: "Align Ruby Version Between Local and CI",
        category: "practical",
        column: "Backlog",
        note: "Next step from Jekyll setup post",
        description: "Local environment runs Ruby 3.3 while CI is pinned to Ruby 3.1. No divergence observed yet, but if a local build passes while CI fails, gem version incompatibility is the first suspect. Track aligning the versions or pinning gems to prevent silent breakage.",
        phases: [
          { id: "ns-9-1", label: "Investigate Ruby 3.3 vs CI 3.1 divergence impact", done: false },
          { id: "ns-9-2", label: "Update CI workflow Ruby version or pin gem versions", done: false },
          { id: "ns-9-3", label: "Test full CI pipeline after changes", done: false },
        ]
      },
      {
        id: "ns-1",
        title: "MikroTik Inter-VLAN Firewall Rules",
        category: "practical",
        column: "Backlog",
        note: "Next step from VLAN segmentation post",
        description: "Block Guest and IoT VLANs from reaching the User VLAN; restrict IoT traffic to internet only. Uses the negative ping test from the segmentation post as the before-baseline — once rules are applied, that test must fail to confirm enforcement. Includes before/after nmap scan diff as publishable evidence.",
        phases: [
          { id: "ns-1-1", label: "Research MikroTik firewall chain structure for inter-VLAN", done: false },
          { id: "ns-1-2", label: "Write and apply rules to block IoT/Guest from User VLAN", done: false },
          { id: "ns-1-3", label: "Run negative ping test and nmap scan to verify enforcement", done: false },
          { id: "ns-1-4", label: "Verify internet access still works from all VLANs", done: false },
          { id: "ns-1-5", label: "Document rules and publish post", done: false },
        ]
      },
      {
        id: "ns-2",
        title: "Management VLAN 10 Setup",
        category: "practical",
        column: "Backlog",
        note: "Next step from VLAN segmentation post",
        description: "Create VLAN 10 for all infrastructure management traffic — MikroTik router, TP-Link switch, and EAP225 APs. Separates management access from user-facing VLANs and reduces attack surface if a user-side device is compromised.",
        phases: [
          { id: "ns-2-1", label: "Design VLAN 10 scope and list all management interfaces", done: false },
          { id: "ns-2-2", label: "Configure VLAN 10 on MikroTik, switch, and APs", done: false },
          { id: "ns-2-3", label: "Migrate management access and verify connectivity", done: false },
          { id: "ns-2-4", label: "Verify isolation from user-facing VLANs", done: false },
          { id: "ns-2-5", label: "Document and publish post", done: false },
        ]
      },
      {
        id: "ns-3",
        title: "Pi-hole DNS Deployment Across All VLANs",
        category: "practical",
        column: "Backlog",
        note: "Next step from VLAN segmentation post",
        description: "Deploy Pi-hole on VLAN 20 and route DNS from all three VLANs through it. Requires DHCP server updates, inter-VLAN firewall allow rules for DNS, a NAT redirect rule to catch bypass attempts, and per-VLAN blocklist policies. Pi-hole query logs per VLAN also enable additional IDS detection scenarios.",
        phases: [
          { id: "ns-3-1", label: "Install and configure Pi-hole on VLAN 20", done: false },
          { id: "ns-3-2", label: "Update DHCP dns-server option for all three VLANs", done: false },
          { id: "ns-3-3", label: "Add firewall rules to allow DNS from IoT/Guest to Pi-hole", done: false },
          { id: "ns-3-4", label: "Add NAT redirect rule for hardcoded upstream bypass", done: false },
          { id: "ns-3-5", label: "Test per-VLAN DNS behavior and document", done: false },
        ]
      },
      {
        id: "ns-4",
        title: "mDNS Reflector for Cross-VLAN Device Discovery",
        category: "practical",
        column: "Backlog",
        note: "Next step from VLAN segmentation post",
        description: "Evaluate and implement an mDNS reflector to restore Chromecast, AirPlay, and printer discovery across the VLAN 20/30 boundary. mDNS is link-local and does not cross VLANs by default. Options include Avahi on the Shuttle or a MikroTik service. Security implications of selective reflection must be explicitly scoped.",
        phases: [
          { id: "ns-4-1", label: "Audit mDNS-dependent services and decide reflection scope", done: false },
          { id: "ns-4-2", label: "Install and configure Avahi or equivalent reflector", done: false },
          { id: "ns-4-3", label: "Test Chromecast/AirPlay discovery across VLAN boundary", done: false },
          { id: "ns-4-4", label: "Assess and document security implications", done: false },
        ]
      },
      {
        id: "ns-5",
        title: "Port Mirroring and Shuttle IDS Sensor Connection",
        category: "lab",
        column: "Backlog",
        note: "Next step from VLAN segmentation post",
        description: "Physically connect the Shuttle to switch port 8 and configure port mirroring on the TL-SG108E (source ports 1, 6, 7 → destination port 8, both directions). Verify frames arrive on the sensor interface with tcpdump and confirm VLAN tags are preserved through the mirror.",
        phases: [
          { id: "ns-5-1", label: "Physically connect Shuttle eth1 to switch port 8", done: false },
          { id: "ns-5-2", label: "Configure port mirroring on TL-SG108E", done: false },
          { id: "ns-5-3", label: "Verify frames arrive on sensor with tcpdump", done: false },
          { id: "ns-5-4", label: "Confirm VLAN tags preserved through mirror", done: false },
          { id: "ns-5-5", label: "Capture Wireshark artifacts and publish post", done: false },
        ]
      },
      {
        id: "ns-6",
        title: "Zeek Deployment on Shuttle Sensor",
        category: "lab",
        column: "Backlog",
        note: "Next step from VLAN segmentation post",
        description: "Install and configure Zeek on the Shuttle machine listening on the mirror interface (eth1). Validate that conn.log shows traffic from all three VLAN subnets (10.0.20.x, 10.0.30.x, 10.0.40.x). Configure log rotation and retention, then publish a deployment walkthrough post.",
        phases: [
          { id: "ns-6-1", label: "Install Zeek on Shuttle and configure for eth1", done: false },
          { id: "ns-6-2", label: "Validate conn.log traffic from all three VLAN subnets", done: false },
          { id: "ns-6-3", label: "Configure log rotation and retention policy", done: false },
          { id: "ns-6-4", label: "Document deployment and publish post", done: false },
        ]
      },
      {
        id: "ns-7",
        title: "Inter-VLAN Anomaly Detection with Zeek",
        category: "lab",
        column: "Backlog",
        note: "Next step from VLAN segmentation post",
        description: "Build the first detection use case: alert when an IoT VLAN device (10.0.30.x) initiates a connection to the User VLAN (10.0.20.x). This is the Zeek scripting entry point for the lab, producing structured alerts that can feed into a Grafana dashboard or log aggregator.",
        phases: [
          { id: "ns-7-1", label: "Research Zeek conn.log fields for cross-VLAN detection", done: false },
          { id: "ns-7-2", label: "Write Zeek script to detect IoT-to-User VLAN connections", done: false },
          { id: "ns-7-3", label: "Test against crafted cross-VLAN traffic in lab", done: false },
          { id: "ns-7-4", label: "Tune alert format and publish detection post", done: false },
        ]
      },
    ];

    // ── CardItem component ─────────────────────────────────────────────────
    function CardItem({ card, onClick }) {
      const cat = CATEGORIES[card.category] || CATEGORIES['lab'];
      const hasPhases = card.phases && card.phases.length > 0;
      const total = hasPhases ? card.phases.length : 0;
      const done = hasPhases ? card.phases.filter(p => p.done).length : 0;
      const pct = total > 0 ? (done / total) * 100 : 0;

      return (
        <div
          className="card"
          style={{ borderLeft: `3px solid ${cat.color}` }}
          onClick={onClick}
        >
          <div className="card-top">
            <span className="card-symbol" style={{ color: cat.color }}>{cat.symbol}</span>
            <span className="card-title">{card.title}</span>
          </div>
          {card.note && <div className="card-note">{card.note}</div>}
          {hasPhases && (
            <div className="card-progress-track">
              <div
                className="card-progress-fill"
                style={{ width: `${pct}%`, background: cat.color }}
              />
            </div>
          )}
        </div>
      );
    }

    // ── DetailModal component ──────────────────────────────────────────────
    function DetailModal({ card, onClose }) {
      const cat = CATEGORIES[card.category] || CATEGORIES['lab'];
      const colColor = COLUMN_COLORS[card.column] || '#6e7d8c';
      const hasPhases = card.phases && card.phases.length > 0;
      const total = hasPhases ? card.phases.length : 0;
      const doneCount = hasPhases ? card.phases.filter(p => p.done).length : 0;

      // Close on Escape
      useEffect(() => {
        function onKey(e) {
          if (e.key === 'Escape') onClose();
        }
        document.addEventListener('keydown', onKey);
        return () => document.removeEventListener('keydown', onKey);
      }, [onClose]);

      function handleOverlayClick(e) {
        if (e.target === e.currentTarget) onClose();
      }

      return (
        <div className="modal-overlay" onClick={handleOverlayClick}>
          <div
            className="modal-panel"
            style={{ borderLeft: `4px solid ${cat.color}` }}
          >
            {/* Header */}
            <div className="modal-header">
              <div className="modal-meta">
                <span className="modal-category" style={{ color: cat.color }}>
                  {cat.symbol} {cat.label}
                </span>
                <span className="modal-column-badge" style={{ color: colColor }}>
                  {card.column}
                </span>
              </div>
              <div className="modal-title">{card.title}</div>
              {card.note && <div className="modal-note">{card.note}</div>}
            </div>

            {/* Body */}
            <div className="modal-body">
              {/* Overview */}
              {card.description && (
                <div>
                  <div className="modal-section-heading">// OVERVIEW</div>
                  <p className="modal-description">{card.description}</p>
                </div>
              )}

              {/* Phases */}
              {hasPhases && (
                <div>
                  <div className="modal-section-heading">// PHASES</div>
                  <div className="modal-phases-summary" style={{ color: cat.color }}>
                    {doneCount} / {total} completed
                  </div>
                  <div className="phases-list">
                    {card.phases.map(phase => (
                      <div key={phase.id} className="phase-row">
                        <input
                          type="checkbox"
                          className="phase-checkbox"
                          checked={phase.done}
                          disabled
                          style={{ '--check-color': cat.color }}
                          onChange={() => {}}
                        />
                        <span className={`phase-label${phase.done ? ' done' : ''}`}>
                          {phase.label}
                        </span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>

            {/* Footer */}
            <div className="modal-footer">
              <button className="modal-close-btn" onClick={onClose}>✕ CLOSE</button>
            </div>
          </div>
        </div>
      );
    }

    // ── Main App ───────────────────────────────────────────────────────────
    function App() {
      const [filter, setFilter] = useState(null);
      const [selectedCard, setSelectedCard] = useState(null);

      const handleCloseModal = useCallback(() => setSelectedCard(null), []);

      const visibleCards = filter ? CARDS.filter(c => c.category === filter) : CARDS;

      return (
        <>
          {/* Header */}
          <header className="header">
            <div className="header-title">
              <span className="header-prompt">▶ ondrej@lab</span>{' '}
              <span className="header-path">~/projects/ids-lab</span>
            </div>
            <div className="header-divider" />
            <div className="filters">
              <span className="filter-label">Filter:</span>
              <button
                className={`filter-btn${filter === null ? ' active' : ''}`}
                style={{ color: '#b3b1ad' }}
                onClick={() => setFilter(null)}
              >
                ALL
              </button>
              {Object.entries(CATEGORIES).map(([key, { label, color, symbol }]) => (
                <button
                  key={key}
                  className={`filter-btn${filter === key ? ' active' : ''}`}
                  style={{ color }}
                  onClick={() => setFilter(filter === key ? null : key)}
                >
                  {symbol} {label}
                </button>
              ))}
            </div>
          </header>

          {/* Board */}
          <div className="board">
            {COLUMNS.map(col => {
              const colCards = visibleCards.filter(c => c.column === col);
              const allCount = CARDS.filter(c => c.column === col).length;
              return (
                <div key={col} className="column">
                  <div className="column-header">
                    <div className="column-dot" style={{ background: COLUMN_COLORS[col] }} />
                    <span className="column-title" style={{ color: COLUMN_COLORS[col] }}>{col}</span>
                    <span className="column-count">{allCount}</span>
                  </div>
                  <div className="column-body">
                    {colCards.length === 0 && (
                      <div className="empty-state">— empty —</div>
                    )}
                    {colCards.map(card => (
                      <CardItem
                        key={card.id}
                        card={card}
                        onClick={() => setSelectedCard(card)}
                      />
                    ))}
                  </div>
                </div>
              );
            })}
          </div>

          {/* Detail Modal */}
          {selectedCard && (
            <DetailModal
              card={selectedCard}
              onClose={handleCloseModal}
            />
          )}
        </>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
